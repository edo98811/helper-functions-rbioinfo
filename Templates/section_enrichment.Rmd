# Enrichment
<!-- 
</details>

<details>
## Analysis with topGO -->
```{r setup-enrichment}
expressedInAssay <- (rowSums(assay(dds))>0)
geneUniverseExprENS <- rownames(dds)[expressedInAssay]
geneUniverseExpr <- anno_df$gene_name[match(geneUniverseExprENS, anno_df$gene_id)]
```

```{r enrichment, eval = TRUE, echo = FALSE}
# enrichment with topGO
if (!purrr::pluck(params, "load_dds_objects", .default = FALSE)) {
  for (i in names(myresuSet)) {
    message(i)
    if (nrow(myresuSet[[i]][["tbl_res_DE"]]) > 0) {
      myresuSet[[i]][["topGO_tbl"]] <- 
        topGOtable(DEgenes = myresuSet[[i]][["tbl_res_DE"]]$geneSymbol, 
                  BGgenes = geneUniverseExpr, 
                  ontology = "BP",
                  geneID = "symbol",
                  addGeneToTerms = TRUE, 
                  topTablerows = 500,
                  mapping = "org.Mm.eg.db")
    }
  }
}
```

## contrasts
```{r, echo = FALSE,include = FALSE}
# You need this code to conduct the magic dependences attaching...
DT::datatable(matrix())
```

```{r enrichment-tables-1, eval = TRUE, echo = FALSE, results = 'asis'}
for (contrast in finerenone_contrasts){
  cat(
    knitr::knit_print(
      DT::datatable(
        myresuSet[[contrast]]$topGO_tbl, 
        escape = FALSE, 
        rownames = TRUE, 
        caption = htmltools::tags$caption(style = 'caption-side: top; color:black; font-size: 2em', paste0("Enrichment ", contrast)
        )
      )
    )
  )
}
```